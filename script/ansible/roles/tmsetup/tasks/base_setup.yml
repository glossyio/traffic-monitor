---
# TMSetup - Base Setup tasks
- name: TMSetup - Base Setup - Add TM user to sudo group
  become: true
  ansible.builtin.user:
    name: '{{ tmsetup_codeowner }}'
    groups: sudo
    append: true

- name: TMSetup - Base Setup - Run full update
  become: true
  ansible.builtin.apt:
    update_cache: true
    upgrade: full

- name: TMSetup - Base Setup - Create code owner
  become: true
  ansible.builtin.user:
    name: '{{ tmsetup_codeowner }}'
    state: present
  register: tmsetup_base_register_user_codeowner

- name: TMSetup - Base Setup - Set var for codeowner home directory
  ansible.builtin.set_fact:
    tmsetup_codeowner_homedir: tmsetup_base_register_user_codeowner.home

- name: TMSetup - Base Setup - Set timezone
  become: true
  community.general.timezone:
    name: '{{ tmsetup_timezone }}'

- name: TMSetup - Base Setup - Create Directories
  become: true
  ansible.builtin.file:
    path: '{{ item }}'
    state: directory
    mode: '0750'
    owner: '{{ tmsetup_codeowner }}'
  loop:
    - '{{ tmsetup_codedir }}'

- name: TMSetup - Base Setup - Install required packages
  become: true
  ansible.builtin.apt:
    name: '{{ tmsetup_packages }}'
    state: present
    update_cache: false
...
